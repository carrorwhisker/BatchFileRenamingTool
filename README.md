# 批量文件处理工具集

一套简单易用的批量文件处理工具集，包含三个独立的工具，帮助您高效处理文件操作。

## 📦 工具列表

### 1. 📝 批量文件生成工具 (`index.html`)
根据模板文件和数据批量生成多个不同名称的文件副本。

### 2. 🔄 批量文件重命名工具 (`rename.html`)
批量修改文件名，支持替换和删除指定位置的字符。

### 3. 📊 Excel 批量编辑工具 (`excel-edit.html`)
批量修改多个 Excel 文件的单元格内容。

---

## 🚀 工具一：批量文件生成工具

### 功能特点

- 📁 **模板文件支持**：选择任意文件作为模板
- 📊 **数据管理**：通过表格管理数据，支持动态添加/删除行和列
- 🎯 **变量模板**：使用 `{变量名}` 格式定义文件名模板
- 👁️ **实时预览**：生成前预览所有文件名称
- 🌐 **多语言支持**：支持中文和英文界面切换
- 💾 **批量下载**：一键生成并下载所有文件

### 使用方法

#### 1. 选择模板文件

点击"选择模板文件"按钮，选择一个文件作为模板。这个文件将被复制并生成多个不同名称的文件副本。

#### 2. 管理数据

在"数据管理"区域：
- 点击"+ 添加数据行"添加新的数据行
- 点击"+ 添加列"添加新的数据列
- 点击表头的"×"按钮删除列
- 点击每行的"删除"按钮删除数据行
- 可以直接编辑表格中的数据和列名

#### 3. 配置文件名模板

在"文件名模板配置"区域：
- 输入文件名模板，使用 `{变量名}` 格式定义变量
- 例如：`示例文档_{编号}_{日期}_{项目名称}.xls`
- 变量名会自动匹配数据管理的列名
- 如果变量名与列名不匹配，需要在下拉菜单中选择对应的数据列

#### 4. 预览和生成

- 在"生成文件预览"区域查看将要生成的文件列表
- 点击"刷新预览"更新预览
- 确认无误后，点击"生成文件"按钮
- 文件将自动下载到浏览器默认下载目录

### 使用示例

假设您有一个 Excel 模板文件 `template.xls`，需要生成多个不同名称的副本：

1. **选择模板文件**：选择 `template.xls`

2. **准备数据**：
   - 列1：项目名称
   - 列2：编号
   - 列3：日期

3. **填写数据**：
   ```
   项目名称    编号    日期
   示例项目A   A001    20250101
   示例项目B   A002    20250115
   ```

4. **设置模板**：`示例文档_{编号}_{日期}_{项目名称}.xls`

5. **生成文件**：
   - `示例文档_A001_20250101_示例项目A.xls`
   - `示例文档_A002_20250115_示例项目B.xls`

---

## 🔄 工具二：批量文件重命名工具

### 功能特点

- 📁 **批量选择**：支持一次选择多个文件进行重命名
- ✂️ **替换字符**：从指定位置开始替换指定长度的字符
- 🗑️ **删除字符**：从指定位置开始删除指定长度的字符
- 📋 **多规则支持**：可以添加多个规则，按顺序执行
- 🎯 **快速选择**：交互式文件名选择器，点击或拖动即可选择字符
- 👁️ **实时预览**：重命名前预览所有文件的新名称
- 🌐 **多语言支持**：支持中文和英文界面切换
- 💾 **直接修改**：支持直接修改源文件（需要浏览器支持 File System Access API）

### 使用方法

#### 1. 选择文件

点击"选择文件"按钮，选择需要重命名的文件（可多选）。

#### 2. 添加重命名规则

点击"+ 添加替换规则"或"+ 添加删除规则"按钮：

**方式一：手动输入**
- 设置起始位置（从1开始，不包含扩展名）
- 设置替换/删除长度
- 如果是替换规则，输入替换后的文本

**方式二：快速选择（推荐）**
- 在对话框中选择要使用的文件
- 在文件名选择器中点击或拖动选择字符
- 位置和长度会自动填充

#### 3. 管理规则

- 每个规则可以独立配置、删除
- 使用 ↑↓ 按钮调整规则执行顺序
- 规则会按顺序执行，可以同时应用多个规则

#### 4. 预览和应用

- 在"重命名预览"区域查看重命名效果
- 确认无误后，点击"应用重命名"按钮
- 如果浏览器支持，会直接修改源文件；否则会下载重命名后的文件

### 使用示例

假设您有一批文件需要重命名：

**原文件名**：`报告_2024_01_15_最终版.docx`

**需求**：删除日期部分，将 `2024_01_15` 替换为 `20240115`

**操作步骤**：
1. 选择文件
2. 添加删除规则：位置 4，长度 1（删除下划线）
3. 添加删除规则：位置 7，长度 1（删除下划线）
4. 添加替换规则：位置 4，长度 10，替换为 `20240115`

**结果**：`报告_20240115_最终版.docx`

---

## 📊 工具三：Excel 批量编辑工具

### 功能特点

- 📁 **批量处理**：支持同时处理多个 Excel 文件
- 📝 **单元格编辑**：精确修改指定单元格的内容
- 📊 **表格配置**：通过表格配置批量修改规则
- 💾 **批量下载**：处理完成后批量下载修改后的文件

### 使用方法

#### 1. 上传 Excel 文件

点击文件选择按钮，选择一个或多个 Excel 文件（.xlsx 或 .xls 格式）。

#### 2. 配置修改规则

在"单元格修改配置"区域：
- 默认列：文件、单元格坐标、新内容
- 可以添加更多列来扩展配置
- 每行代表一个单元格修改配置

**配置示例**：
```
文件         单元格坐标    新内容
report1.xlsx  A1          新标题
report1.xlsx  B5          新数据
report2.xlsx  C3          更新内容
```

#### 3. 开始处理

- 点击"开始处理"按钮
- 工具会按照配置批量修改所有文件
- 处理完成后，修改后的文件会自动下载

### ⚠️ 重要限制

**合并单元格限制**：
- ⚠️ **本工具不支持包含合并单元格的 Excel 文件**
- 如果 Excel 文件中存在合并单元格，处理时会出现报错
- 使用前请确保 Excel 文件中没有合并单元格
- 如果必须处理包含合并单元格的文件，请先取消合并后再使用本工具

### 使用示例

假设您需要批量更新多个报表文件中的标题：

1. **上传文件**：选择 `report1.xlsx`、`report2.xlsx`、`report3.xlsx`

2. **配置规则**：
   ```
   文件         单元格坐标    新内容
   report1.xlsx  A1          2024年度报告
   report2.xlsx  A1          2024年度报告
   report3.xlsx  A1          2024年度报告
   ```

3. **处理文件**：点击"开始处理"，所有文件的 A1 单元格都会被更新为"2024年度报告"

---

## 🛠️ 技术说明

### 通用特性

- **纯前端实现**：所有工具都是纯前端实现，无需服务器
- **浏览器兼容性**：
  - Chrome/Edge（推荐）
  - Firefox
  - Safari

### 各工具技术细节

#### 批量文件生成工具
- 使用 HTML5 File API 读取文件
- 使用 Blob API 创建文件副本
- 支持所有文件类型（Excel、Word、PDF、图片等）

#### 批量文件重命名工具
- 使用 HTML5 File API 读取文件
- 支持 File System Access API（Chrome/Edge）直接修改源文件
- 不支持时自动降级为下载模式

#### Excel 批量编辑工具
- 使用 ExcelJS 库处理 Excel 文件
- 支持 .xlsx 和 .xls 格式
- ⚠️ **不支持合并单元格**

---

## 📝 注意事项

### 批量文件生成工具
- 生成大量文件时，浏览器可能会提示是否允许多个下载
- 建议每次生成的文件数量不超过 50 个
- 文件扩展名会自动从模板文件继承

### 批量文件重命名工具
- 位置计数从 1 开始，且不包含文件扩展名
- 规则按顺序执行，后执行的规则基于前一个规则的结果
- 如果浏览器不支持 File System Access API，会下载重命名后的文件

### Excel 批量编辑工具
- ⚠️ **不支持包含合并单元格的 Excel 文件**
- 单元格坐标使用 Excel 标准格式（如 A1、B5、C3）
- 建议先备份原始文件

---

## 🌐 语言切换

所有工具都支持中英文界面切换：
- 点击右上角的语言切换按钮（EN/中文）
- 界面会立即切换到对应语言

---

## 📄 文件说明

- `index.html` - 批量文件生成工具
- `rename.html` - 批量文件重命名工具
- `excel-edit.html` - Excel 批量编辑工具

---

## 💡 使用建议

1. **批量文件生成工具**：适合需要根据数据批量生成文件副本的场景
2. **批量文件重命名工具**：适合需要批量规范化文件名的场景
3. **Excel 批量编辑工具**：适合需要批量更新 Excel 文件内容的场景（注意合并单元格限制）

---

## ⚠️ 免责声明

- 所有工具均为纯前端实现，文件处理在本地浏览器完成
- 建议在处理重要文件前先备份
- Excel 编辑工具不支持合并单元格，使用前请确保文件符合要求
